# SSH文件传输工具使用示例

## 基本使用流程

### 1. 启动程序
```bash
python ssh_file_copy.py
```

### 2. 主菜单界面
```
==================================================
           SSH文件传输工具
==================================================
1. 传输文件
2. 管理历史记录
3. 退出程序

请选择操作 (1-3):
```

### 3. 选择传输文件
输入 `1` 选择传输文件功能。

### 4. 历史配置选择
如果有历史记录，会显示如下界面：
```
=== 历史配置记录 ===
 1. 2024-01-15 10:30:00 - 192.168.1.100:22 - admin - document.pdf
    IP: 192.168.1.100:22
    用户: admin
    源文件: /home/user/document.pdf
    目标: /var/www/uploads/document.pdf

 2. 2024-01-14 15:45:00 - 10.0.0.50:2222 - developer - backup.tar.gz
    IP: 10.0.0.50:2222
    用户: developer
    源文件: /tmp/backup.tar.gz
    目标: /home/backups/backup_20240114.tar.gz

请选择历史配置 (1-2) 或输入 'n' 创建新配置:
```

### 5. 选择配置方式

#### 方式A：使用历史配置
- 输入数字（如 `1`）选择历史配置
- 程序会提示输入密码：`请输入密码: `
- 输入密码后开始传输

#### 方式B：创建新配置
- 输入 `n` 创建新配置
- 按提示输入所有连接信息

### 6. 传输过程
程序会自动选择最佳传输方式并显示进度：
```
使用SFTP传输文件...
文件大小: 1048576 字节
✓ 创建目录: /var/www/uploads
✓ SFTP传输完成
传输时间: 2.34 秒
传输速度: 0.43 MB/s
✓ 文件传输验证成功！MD5值匹配
✓ 文件传输成功！
配置已添加到历史记录
```

## 历史记录管理

### 1. 进入历史记录管理
在主菜单输入 `2` 选择管理历史记录。

### 2. 管理菜单
```
=== 历史记录管理 ===
1. 查看历史记录
2. 删除指定记录
3. 清空所有记录
4. 返回主菜单

请选择操作 (1-4):
```

### 3. 查看历史记录
输入 `1` 查看所有历史记录。

### 4. 删除指定记录
输入 `2` 删除指定记录：
```
=== 历史配置记录 ===
 1. 2024-01-15 10:30:00 - 192.168.1.100:22 - admin - document.pdf
    IP: 192.168.1.100:22
    用户: admin
    源文件: /home/user/document.pdf
    目标: /var/www/uploads/document.pdf

请选择要删除的记录 (1-1) 或输入 'c' 取消:
```

### 5. 清空所有记录
输入 `3` 清空所有历史记录：
```
确定要清空所有历史记录吗？(y/N):
```

## 配置文件说明

### 主配置文件：ssh_transfer_config.json
保存当前使用的配置：
```json
{
  "ip": "192.168.1.100",
  "port": 22,
  "username": "admin",
  "password": "password123",
  "source_file": "/home/user/document.pdf",
  "target_dir": "/var/www/uploads",
  "target_filename": "document.pdf",
  "target_path": "/var/www/uploads/document.pdf"
}
```

### 历史记录文件：ssh_transfer_history.json
保存历史配置记录（不包含密码）：
```json
[
  {
    "timestamp": "2024-01-15T10:30:00",
    "ip": "192.168.1.100",
    "port": 22,
    "username": "admin",
    "source_file": "/home/user/document.pdf",
    "target_dir": "/var/www/uploads",
    "target_filename": "document.pdf",
    "target_path": "/var/www/uploads/document.pdf",
    "description": "192.168.1.100:22 - admin - document.pdf"
  }
]
```

## 使用技巧

### 1. 快速重用配置
- 对于经常传输到同一服务器的文件，使用历史配置可以大大提高效率
- 只需输入密码即可开始传输

### 2. 配置管理
- 定期清理不需要的历史记录
- 使用描述性的文件名，便于识别历史记录

### 3. 安全性
- 历史记录不保存密码，确保安全性
- 每次使用历史配置都需要重新输入密码

### 4. 批量传输
- 可以快速切换不同的历史配置进行批量传输
- 支持修改历史配置中的任何参数

## 常见问题

### Q: 历史记录保存在哪里？
A: 历史记录保存在 `ssh_transfer_history.json` 文件中，与程序在同一目录。

### Q: 如何备份历史记录？
A: 直接复制 `ssh_transfer_history.json` 文件即可备份历史记录。

### Q: 历史记录有数量限制吗？
A: 最多保存20条历史记录，超出时自动删除最旧的记录。

### Q: 可以修改历史记录吗？
A: 选择历史记录后，可以修改任何参数，修改后的配置会作为新记录保存。

### Q: 密码安全吗？
A: 历史记录不保存密码，每次使用都需要重新输入，确保安全性。